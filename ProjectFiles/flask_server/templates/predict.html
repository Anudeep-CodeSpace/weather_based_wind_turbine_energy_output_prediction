<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WindCore ‚Äî Predict</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- NAV -->
<nav class="predict-nav">
  <a class="nav-logo" href="/">Wind<span>Core</span></a>
  <div class="nav-breadcrumb">
    <span>Home</span>
    <span class="sep">/</span>
    <span class="current">Predict</span>
  </div>
  <a class="back-link" href="/">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
    Back
  </a>
</nav>

<!-- MAIN -->
<main class="main">

  <div class="page-header">
    <div class="label">// Prediction Engine</div>
    <h1>Energy Output<br>Forecast</h1>
    <p>Fetch live weather for your city, or enter values manually to run the model.</p>
  </div>

  <div class="layout">

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         LEFT: WEATHER FETCH
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="panel">
      <div class="panel-title">
        Weather Fetch
        <span class="badge">Step 01</span>
      </div>

      <form action="/windapi" method="POST">
        <div class="form-group">
          <label for="city">City name</label>
          <input type="text" id="city" name="city" placeholder="e.g. Copenhagen, Berlin, Chicago" required/>
        </div>
        <button type="submit" class="btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
          </svg>
          Fetch Weather Data
        </button>
      </form>

      <!-- Weather results -->
      <div class="weather-result" style="display: {{ 'block' if temp is defined and temp else 'none' }}">
        <div class="weather-grid">
          <div class="weather-card">
            <div class="wc-icon">üå°</div>
            <div class="wc-label">Temperature</div>
            <div class="wc-value">{{ temp if temp is defined else '‚Äî' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">üíß</div>
            <div class="wc-label">Humidity</div>
            <div class="wc-value">{{ humid if humid is defined else '‚Äî' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">üîµ</div>
            <div class="wc-label">Pressure</div>
            <div class="wc-value">{{ pressure if pressure is defined else '‚Äî' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">üå¨</div>
            <div class="wc-label">Wind Speed</div>
            <div class="wc-value">{{ speed if speed is defined else '‚Äî' }}</div>
          </div>
        </div>
        <p class="note">
          ‚úì Weather data loaded. Copy these values into the manual predictor on the right to generate an energy forecast.
        </p>
      </div>

      <!-- Empty state -->
      <div class="weather-empty" style="display: {{ 'none' if temp is defined and temp else 'flex' }}">
        <div class="icon">üåç</div>
        <div>Enter a city to fetch live conditions</div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         RIGHT: MANUAL PREDICTOR
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="panel">
      <div class="panel-title">
        Manual Predictor
        <span class="badge">Step 02</span>
      </div>

      <form action="/y_predict" method="POST" id="predict-form">
        <div class="form-group">
          <label for="theoretical_power">Theoretical Power</label>
          <input type="number" id="theoretical_power" name="theoretical_power"
                 step="0.01" placeholder="e.g. 1250.00"
                 required/>
          <div class="input-hint">KWh</div>
        </div>

        <div class="form-group">
          <label for="wind_speed">Wind Speed</label>
          <input type="number" id="wind_speed" name="wind_speed"
                 step="0.01" placeholder="e.g. 8.3"
                 value="{{ speed | replace(' m/s','') if speed is defined and speed else '' }}"
                 required/>
          <div class="input-hint">Metres / second</div>
        </div>

        <button type="submit" class="btn btn-green">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
          </svg>
          Run Energy Prediction
        </button>
      </form>

      <!-- Prediction result -->
      <div class="prediction-box" style="display: {{ 'flex' if prediction_text is defined and prediction_text else 'none' }}">
        <div class="pred-icon">‚ö°</div>
        <div>
          <div class="pred-label">Predicted Output</div>
          <div class="pred-value" id="pred-display">
            {% if prediction_text is defined and prediction_text %}
              {{ prediction_text | replace('The energy predicted is ', '') | replace(' KWh', '') }}
              <span class="pred-unit">KWh</span>
            {% else %}‚Äî{% endif %}
          </div>
          {% if prediction_text is defined and prediction_text %}
          <div style="color: var(--muted); font-size:.72rem; margin-top:8px; letter-spacing:.1em;">
            ESTIMATED ENERGY GENERATION
          </div>
          {% endif %}
        </div>
      </div>

      <!-- Empty prediction state -->
      <div class="prediction-empty" style="display: {{ 'none' if prediction_text is defined and prediction_text else 'flex' }}">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
        </svg>
        <div>Submit values to see prediction</div>
      </div>
    </div>

  </div><!-- /layout -->

  <!-- BOTTOM BAR -->
  <div class="result-bar">
    <div>
      <div class="rb-text">Model: Random Forest Regressor &nbsp;¬∑&nbsp; Input: Theoretical Power &amp; Wind Speed</div>
      <div class="rb-sub">Predictions are estimates. Real-world output varies by turbine model, terrain, and grid conditions.</div>
    </div>
    <a class="rb-cta" href="/">‚Üê Back to overview</a>
  </div>

</main>

<script>
  // Animate form fields on load
  document.querySelectorAll('.form-group').forEach((el, i) => {
    el.style.animation = `fadeUp .5s ${.1 + i * .07}s both`;
  });

  // Highlight active input row
  document.querySelectorAll('input').forEach(inp => {
    inp.addEventListener('focus', () => {
      inp.parentElement.querySelector('label').style.color = 'var(--cyan)';
    });
    inp.addEventListener('blur', () => {
      inp.parentElement.querySelector('label').style.color = '';
    });
  });

  // Button loading state
  document.querySelectorAll('form').forEach(form => {
    form.addEventListener('submit', function() {
      const btn = this.querySelector('button[type=submit]');
      btn.style.opacity = '.7';
      btn.textContent = 'Processing...';
    });
  });
</script>
</body>
</html>
